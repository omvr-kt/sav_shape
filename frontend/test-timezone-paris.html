<!DOCTYPE html>
<html lang="fr" class="theme-shape">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Fuseau Horaire Paris</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 20px;
            background: #f5f5f5;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin: 10px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-result {
            background: #e8f5e8;
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
            border-left: 4px solid #4CAF50;
        }
        .time-display {
            font-size: 18px;
            font-weight: bold;
            color: #333;
        }
    </style>
</head>
<body>
    <h1>Test du Fuseau Horaire Paris (Europe/Paris)</h1>
    
    <div class="test-section">
        <h2>1. Heure actuelle</h2>
        <div class="test-result">
            <div>Heure UTC : <span id="utcTime" class="time-display"></span></div>
            <div>Heure Paris (Europe/Paris) : <span id="parisTime" class="time-display"></span></div>
            <div>Différence UTC : <span id="timeDiff" class="time-display"></span></div>
        </div>
    </div>

    <div class="test-section">
        <h2>2. Test des saisons (changement automatique hiver/été)</h2>
        <div class="test-result">
            <h3>Été 2024 (CEST - UTC+2) :</h3>
            <div>15 juillet 2024, 14:30 UTC → <span id="summerTest"></span></div>
            
            <h3>Hiver 2024 (CET - UTC+1) :</h3>
            <div>15 janvier 2024, 14:30 UTC → <span id="winterTest"></span></div>
            
            <h3>Changement été → hiver :</h3>
            <div>Dernier dimanche d'octobre 2024 → <span id="winterChangeTest"></span></div>
            
            <h3>Changement hiver → été :</h3>
            <div>Dernier dimanche de mars 2024 → <span id="summerChangeTest"></span></div>
        </div>
    </div>

    <div class="test-section">
        <h2>3. Test des fonctions de timezone-utils.js</h2>
        <div id="timezoneTests" class="test-result">
            <!-- Les tests seront injectés par JavaScript -->
        </div>
    </div>

    <script src="/assets/js/timezone-utils.js"></script>
    <script>
        // Test 1: Affichage de l'heure actuelle
        function updateCurrentTime() {
            const now = new Date();
            
            // UTC
            document.getElementById('utcTime').textContent = now.toISOString();
            
            // Paris
            const parisTime = now.toLocaleString('fr-FR', {
                timeZone: 'Europe/Paris',
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit'
            });
            document.getElementById('parisTime').textContent = parisTime;
            
            // Différence UTC
            const parisOffset = -now.getTimezoneOffset() / 60;
            const parisDate = new Date(now.toLocaleString("en-US", {timeZone: "Europe/Paris"}));
            const utcDate = new Date(now.toISOString());
            const actualOffset = (parisDate.getTime() - utcDate.getTime()) / (1000 * 60 * 60);
            document.getElementById('timeDiff').textContent = `UTC${actualOffset >= 0 ? '+' : ''}${Math.round(actualOffset)}`;
        }
        
        // Test 2: Tests saisonniers
        function runSeasonalTests() {
            // Test été (CEST = UTC+2)
            const summerDate = new Date('2024-07-15T14:30:00Z');
            const summerParis = summerDate.toLocaleString('fr-FR', {
                timeZone: 'Europe/Paris',
                year: 'numeric',
                month: '2-digit', 
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit'
            });
            document.getElementById('summerTest').textContent = `${summerParis} (doit être 16:30)`;
            
            // Test hiver (CET = UTC+1)
            const winterDate = new Date('2024-01-15T14:30:00Z');
            const winterParis = winterDate.toLocaleString('fr-FR', {
                timeZone: 'Europe/Paris',
                year: 'numeric',
                month: '2-digit',
                day: '2-digit', 
                hour: '2-digit',
                minute: '2-digit'
            });
            document.getElementById('winterTest').textContent = `${winterParis} (doit être 15:30)`;
            
            // Test changement vers hiver (dernier dimanche octobre)
            const winterChange = new Date('2024-10-27T01:30:00Z'); // 3h30 avant changement
            const winterChangeParis = winterChange.toLocaleString('fr-FR', {
                timeZone: 'Europe/Paris',
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit'
            });
            document.getElementById('winterChangeTest').textContent = `${winterChangeParis} (UTC+1)`;
            
            // Test changement vers été (dernier dimanche mars)
            const summerChange = new Date('2024-03-31T01:30:00Z'); // 2h30 après changement
            const summerChangeParis = summerChange.toLocaleString('fr-FR', {
                timeZone: 'Europe/Paris',
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit'
            });
            document.getElementById('summerChangeTest').textContent = `${summerChangeParis} (UTC+2)`;
        }
        
        // Test 3: Fonctions timezone-utils
        function testTimezoneUtils() {
            const testContainer = document.getElementById('timezoneTests');
            
            const testDate = new Date('2024-07-15T14:30:00Z');
            
            const tests = [
                {
                    name: 'formatParisDate()',
                    result: formatParisDate(testDate)
                },
                {
                    name: 'formatShortParisDate()',
                    result: formatShortParisDate(testDate)
                },
                {
                    name: 'formatParisTime()',
                    result: formatParisTime(testDate)
                },
                {
                    name: 'getCurrentParisTime()',
                    result: getCurrentParisTime().toString()
                },
                {
                    name: 'getCurrentParisMonth()',
                    result: getCurrentParisMonth()
                }
            ];
            
            let html = '<h3>Tests des fonctions utilitaires :</h3>';
            tests.forEach(test => {
                html += `<div><strong>${test.name}:</strong> ${test.result}</div>`;
            });
            
            testContainer.innerHTML = html;
        }
        
        // Exécuter tous les tests
        updateCurrentTime();
        runSeasonalTests();
        testTimezoneUtils();
        
        // Mettre à jour l'heure courante toutes les secondes
        setInterval(updateCurrentTime, 1000);
    </script>
</body>
</html>